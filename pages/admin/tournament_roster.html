<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Roster del Torneo â€“ Volcanes Ultimate</title>

  <!-- Bootstrap -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Bootstrap Icons -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
  />

  <!-- Estilos globales -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/dashboard.css" />
  <!-- Estilos de esta pantalla -->
  <link rel="stylesheet" href="/css/tournament_roster.css" />
</head>

<body class="loading">

  <!-- HEADER -->
  <div id="app-header"></div>

  <main class="container py-4">

    <!-- Top bar -->
    <div class="mb-3">
      <h1 class="page-title mb-1" id="pageTitle">â€”</h1>
      <div class="text-muted" id="pageSubtitle">â€”</div>
    </div>

    <!-- Tournament hero -->
    <section class="roster-hero mb-3">
      <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">

        <!-- Info torneo -->
        <div>
          <div class="roster-hero__title d-flex align-items-center gap-2">
            <span id="tName">â€”</span>
            <span class="badge text-bg-light border" id="tDates">â€”</span>
          </div>

          <div class="text-muted small" id="tMeta">â€”</div>

          <div class="d-flex gap-2 flex-wrap mt-2 align-items-center">
            <span class="pill" id="teamFeePill">Team fee: â€”</span>

            <button
              class="btn btn-sm btn-outline-secondary"
              id="toggleTeamFeeBtn"
              type="button"
              title="Cambiar estado del fee del equipo"
            >
              <i class="bi bi-cash-coin"></i>
            </button>
          </div>
        </div>

        <!-- Acciones -->
        <div class="d-flex gap-2">
          <a
            class="btn btn-sm btn-outline-primary"
            id="editTournamentBtn"
            href="#"
          >
            <i class="bi bi-pencil"></i>
            Editar
          </a>
          <a
            id="tOfficialLink"
            class="btn btn-sm btn-outline-secondary d-none"
            href="#"
            target="_blank"
            rel="noopener noreferrer"
            title="Abrir sitio oficial"
          >
            <i class="bi bi-link-45deg"></i>
          </a>
        </div>
      </div>
    </section>

    <!-- Errors -->
    <div class="alert alert-warning d-none" id="errorBox"></div>

    <!-- Context hint -->
    <section class="mb-3">
      <div class="text-muted small d-flex align-items-center gap-2">
        <i class="bi bi-people"></i>
        Administra convocados, confirmados y abonos del fee
      </div>
    </section>

    <!-- Layout: 2 columnas -->
    <section class="row g-3">

      <!-- Roster list -->
      <div class="col-12 col-xl-7">
        <div class="panel">

          <!-- Header roster -->
          <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
            <div>
              <div class="panel__title" id="rosterTitle">â€”</div>

              <!-- Stats -->
              <div
                class="panel__sub d-flex gap-2 flex-wrap align-items-center mt-1"
                id="rosterStats"
              >
                <span class="badge text-bg-light border" title="Total de jugadores">
                  ðŸ‘¥ <strong id="statTotal">â€”</strong>
                </span>

                <span class="badge text-bg-light border" title="Femenino / Masculino">
                  â™€ <strong id="statF">â€”</strong> Â· â™‚ <strong id="statM">â€”</strong>
                </span>

                <span class="badge text-bg-light border" title="Handlers">
                  Handlers <strong id="statHandlers">â€”</strong>
                </span>

                <span class="badge text-bg-light border" title="Cutters">
                  Cutters <strong id="statCutters">â€”</strong>
                </span>
              </div>
            </div>

            <!-- Filtros -->
            <div class="dropdown">
              <button
                class="btn btn-sm btn-outline-secondary dropdown-toggle"
                type="button"
                data-bs-toggle="dropdown"
                data-bs-auto-close="outside"
                aria-expanded="false"
                id="filtersDropdownBtn"
              >
                <i class="bi bi-funnel"></i>
                Filtros
                <span class="ms-1 badge text-bg-light border" id="filtersCount" style="display:none;">0</span>
              </button>

              <div class="dropdown-menu p-3" style="min-width: 260px;">
                <div class="fw-semibold mb-2">Mostrar</div>

                <!-- Status -->
                <div class="mb-2">
                  <div class="text-muted small mb-1">Estado</div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_status_confirmado" data-filter="status:confirmado">
                    <label class="form-check-label" for="f_status_confirmado">Confirmado</label>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_status_convocado" data-filter="status:convocado">
                    <label class="form-check-label" for="f_status_convocado">Convocado</label>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_status_tentative" data-filter="status:tentative">
                    <label class="form-check-label" for="f_status_tentative">Por confirmar</label>
                  </div>
                </div>

                <hr class="my-2">

                <!-- Fee -->
                <div class="mb-2">
                  <div class="text-muted small mb-1">Fee</div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_fee_pendiente" data-filter="fee:pendiente">
                    <label class="form-check-label" for="f_fee_pendiente">Pendiente</label>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_fee_pagado" data-filter="fee:pagado">
                    <label class="form-check-label" for="f_fee_pagado">Pagado</label>
                  </div>
                </div>

                <hr class="my-2">

                <!-- Rol -->
                <div class="mb-2">
                  <div class="text-muted small mb-1">Rol</div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_role_handler" data-filter="role:handler">
                    <label class="form-check-label" for="f_role_handler">Handlers</label>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_role_cutter" data-filter="role:cutter">
                    <label class="form-check-label" for="f_role_cutter">Cutters</label>
                  </div>
                </div>

                <hr class="my-2">

                <!-- GÃ©nero -->
                <div class="mb-2">
                  <div class="text-muted small mb-1">GÃ©nero</div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_gender_f" data-filter="gender:f">
                    <label class="form-check-label" for="f_gender_f">Femenino</label>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_gender_m" data-filter="gender:m">
                    <label class="form-check-label" for="f_gender_m">Masculino</label>
                  </div>
                </div>

                <hr class="my-2">

                <!-- Invitados -->
                <div class="mb-2">
                  <div class="form-check">
                    <input class="form-check-input roster-filter-check" type="checkbox" id="f_guest_true" data-filter="guest:true">
                    <label class="form-check-label" for="f_guest_true">Solo invitados</label>
                  </div>
                </div>

                <div class="d-flex gap-2 mt-3">
                  <button class="btn btn-sm btn-outline-secondary w-100" id="clearLegendFilters" type="button">
                    Limpiar
                  </button>
                </div>

                <div class="small text-muted mt-2" id="filtersHint">
                  Tip: puedes combinar filtros.
                </div>
              </div>
            </div>

            </div>
          </div>

          <!-- Roster content -->
          <div class="mt-3" id="rosterList"></div>
          <div class="text-muted p-3 d-none" id="rosterEmpty">â€”</div>
        </div>
      </div>

      <!-- Players panel -->
      <div class="col-12 col-xl-5">
        <div class="panel">

          <!-- Header -->
          <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
            <div>
              <div class="panel__title" id="playersTitle">Jugadores</div>
              <div class="panel__sub text-muted" id="playersSubtitle">â€”</div>
            </div>

            <span
              class="badge text-bg-light border"
              id="addPanelState"
              title="Disponibles en el panel"
            >
              Disponibles: â€”
            </span>
          </div>

          <!-- Acciones -->
          <div class="mt-3 d-flex gap-2 flex-wrap">
            <button
              class="btn btn-sm btn-outline-primary"
              id="addGuestBtn"
              type="button"
            >
              <i class="bi bi-person-plus"></i>
              Invitado / PrÃ©stamo
            </button>
          </div>

          <!-- Search -->
          <div class="mt-3">
            <div class="input-group">
              <span class="input-group-text">
                <i class="bi bi-search"></i>
              </span>
              <input
                class="form-control"
                id="playersSearch"
                placeholder="Buscar jugadores activos..."
              />
            </div>
            <div class="form-text">
              Jugadores disponibles para agregar al roster
            </div>
          </div>

          <!-- Players list -->
          <div class="mt-3" id="playersList"></div>
          <div class="text-muted p-3 d-none" id="playersEmpty">
            No hay jugadores.
          </div>
        </div>
      </div>

    </section>

    <!-- Footer meta -->
    <div class="d-flex align-items-center gap-2 mt-4">
      <i class="bi bi-info-circle text-muted"></i>
      <div class="small text-muted" id="appVersion">vâ€”</div>
    </div>

  </main>

  <!-- Modal mount -->
  <div id="modalMount"></div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Page JS -->
  <script type="module" src="/js/features/tournament_roster.js"></script>
</body>
</html>
